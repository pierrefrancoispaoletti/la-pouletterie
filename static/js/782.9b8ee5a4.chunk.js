"use strict";(self.webpackChunkpouletterie=self.webpackChunkpouletterie||[]).push([[782],{9424:function(e,n,t){t.d(n,{Z:function(){return T}});var r,a,i,s,o,c,u,d=t(4925),l=t(2881),p=t(4483),m=t(2791),f=t(6030),v=t(4719),h=t(5061),x=t(8553),g=t(8285),y=t(4519),j=t(111),Z=t(2411),w=t(168),k=t(5751),b=t(1312),P=k.ZP.div(a||(a=(0,w.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: ",";\n  align-items: center;\n  width: 100%;\n  padding: 12px;\n"])),(function(e){return e.isCart?"flex-start":"space-between"})),C=k.ZP.div(i||(i=(0,w.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  min-height: 100%;\n  div > img {\n    width: 300px;\n    height: 300px;\n  }\n  ","\n"])),(function(e){if(e.isCart)return(0,k.iv)(r||(r=(0,w.Z)(["\n      flex-direction: row;\n      div > img {\n        width: 80px;\n        height: 80px;\n        margin-right: 8px;\n      }\n    "])))})),A=k.ZP.div(s||(s=(0,w.Z)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: ",";\n  flex-grow: 1;\n  h3 {\n    margin: 0;\n    margin-bottom: 22px;\n    font-size: 1em;\n    text-transform: uppercase;\n    text-align: left;\n    align-self: flex-start;\n  }\n  span {\n    font-size: 1em;\n    font-weight: bold;\n    display: inline-block;\n    margin-left: 12px;\n    align-self: flex-start;\n  }\n"])),(function(e){return e.isCart?"space-between":"flex-start"})),E=(k.ZP.div(o||(o=(0,w.Z)(["\n  width: fit-content;\n  margin-left: auto;\n  font-size: 1.3em;\n  margin: 12px 0;\n  height: auto;\n  border: 3px solid ",";\n  background: ",";\n  color: white;\n  font-weight: 700;\n  line-height: 1.5;\n  padding: 0.5em;\n  border-radius: 12px;\n"])),b.O.gold,b.O.green),k.ZP.div(c||(c=(0,w.Z)(["\n  display: flex;\n  width: 100%;\n  justify-content: space-around;\n"])))),_=k.ZP.div(u||(u=(0,w.Z)(["\n  width: fit-content;\n  height: fit-content;\n  img {\n    border-radius: 30px 30px 30px 30px;\n  }\n"]))),z=t(184),S=["children","isCart"],O=function(e){var n,t=e.children,r=e.isCart,a=(0,d.Z)(e,S),i=(0,f.I0)(),s=(0,f.v9)(h.D1);return(0,z.jsxs)(P,{isCart:r,children:[(0,z.jsxs)(C,{isCart:r,children:[(0,z.jsxs)(_,{style:{position:"relative"},children:[!r&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(j.Z,{right:!0,children:(0,x.ov)(a._id,s)}),(0,z.jsx)(j.Z,{left:!0,style:{background:"rgba(255,255,255, 0.2)"},onClick:function(){return i((0,g.Fn)(a))},children:(0,z.jsx)(p.G,{icon:l.Mdf,color:"white",size:"2x"})})]}),(0,z.jsx)("img",{src:"".concat(y.Q,"/uploads/").concat(a.imgURI),alt:null===a||void 0===a?void 0:a.name,loading:"lazy"}),!r&&(0,z.jsx)(Z.Z,{style:{position:"absolute",bottom:"8px",right:"0",width:"100%"},positive:!0,type:"button",onClick:function(){return i((0,v.Xq)(a))},children:"Ajouter au Panier"})]}),(0,z.jsxs)(A,{isCart:r,children:[(0,z.jsx)("h3",{children:a.hidden?"CACHE : ".concat(null===a||void 0===a?void 0:a.name):"".concat(a.name)}),(0,z.jsxs)("span",{children:[null===a||void 0===a||null===(n=a.price)||void 0===n?void 0:n.toFixed(2),(0,z.jsx)("small",{children:"\u20ac"})]})]})]}),(0,z.jsx)(E,{children:t})]})},T=(0,m.memo)(O)},8782:function(e,n,t){t.r(n),t.d(n,{default:function(){return N}});var r,a=t(1413),i=t(2791),s=t(6030),o=t(5061),c=t(9424),u=t(6405),d=t(6871),l=t(8759),p=t(6368),m=function(){var e=(0,d.s0)(),n=(0,s.I0)(),t=(0,s.v9)(p.vI),r=(0,s.v9)(o.D1);(0,i.useEffect)((function(){(0,l.G)(t,r,n,e)}),[r,n,e,t])},f=t(885),v=t(3623),h=t(6398),x=t(3740),g=t(1707),y=t(2411),j=t(168),Z=t(5751),w=t(1312),k=Z.ZP.div(r||(r=(0,j.Z)(["\n  display: flex;\n  text-align: center;\n  justify-content: center;\n  padding: 18px;\n  width: 100%;\n  border: 3px solid ",";\n"])),w.O.red),b=t(184),P=function(e){var n=e.children;return(0,b.jsx)(k,{children:n})},C=10,A="09:30",E="19:00",_="11:00",z=["20090","20167"],S=["dimanche"],O=8500,T=900,I=10,J=t(7577),L=function(){var e=(0,d.s0)(),n=(0,s.I0)(),t=(0,i.useState)(""),r=(0,f.Z)(t,2),a=r[0],c=r[1],u=(0,i.useState)(""),l=(0,f.Z)(u,2),m=l[0],j=l[1],Z=(0,s.v9)(o.D1),w=(0,s.v9)(p.Uy),k=(0,s.v9)(p.vI),_=(0,s.v9)(o.sE),z=(0,s.v9)(h._R),O=(0,s.v9)(h.n_),T=S,I=C,L=E,R=A,D=function(e){c(e),j(""),"delivery"===e&&_<I&&n((0,v.PJ)({status:"error",message:"Un montant de commande de ".concat(I,"\u20ac est necessaire pour etre livr\xe9")}))},B=function(e){j(e)},V=function(){return T.includes(z)?{canOrder:!1,reason:"La boutique est ferm\xe9e : ".concat(T.join(", "))}:J.V<R?{canOrder:!1,reason:"Vous pourrez commander \xe0 partir de ".concat(R.replace(":"," H "))}:J.V>L?{canOrder:!1,reason:"Les commandes sont termin\xe9es pour aujourd'hui, revenez demain !"}:{canOrder:!0}};return V().canOrder?(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Z,{children:"Je Choisis mon mode de livraison"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,b.jsx)(y.Z,{paymentSelection:!0,positive:!0,selected:"take-away"===a,type:"button",onClick:function(){return D("take-away")},children:"A emporter"}),(0,b.jsx)(y.Z,{disabled:_<I||!O,paymentSelection:!0,positive:!0,selected:"delivery"===a,type:"button",onClick:function(){return D("delivery")},children:"Livraison (minimum ".concat(I,"\u20ac)")})]}),a&&"delivery"===a&&_>I&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Z,{children:"Je Choisis mon mode de Paiement"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,b.jsx)(y.Z,{paymentSelection:!0,positive:!0,selected:"payment-on-delivery"===m,type:"button",onClick:function(){return B("payment-on-delivery")},children:"Paiement Esp\xe9ces ou Tickets restaurant \xe0 la livraison"}),(0,b.jsx)(y.Z,{paymentSelection:!0,positive:!0,selected:"CB"===m,type:"button",onClick:function(){return B("CB")},children:"Paiment CB en ligne"})]})]}),(0,b.jsx)("div",{style:{height:"76px"}}),"CB"===m&&(0,b.jsxs)(y.Z,{type:"button",payment:!0,onClick:function(){return e("/paiement")},children:["Payer ",_," \u20ac"]}),("payment-on-delivery"===m||"take-away"===a)&&(0,b.jsxs)(y.Z,{type:"button",payment:!0,onClick:function(){return function(){var t,r,i,s,o,c={user:null===w||void 0===w||null===(t=w.user)||void 0===t?void 0:t._id,products:Z,deliveryAddress:"take-away"===a?"":"".concat(null===w||void 0===w||null===(r=w.user)||void 0===r||null===(i=r.address)||void 0===i?void 0:i.addressFirstLine," ").concat(null===w||void 0===w||null===(s=w.user)||void 0===s||null===(o=s.address)||void 0===o?void 0:o.addressComplement),deliveryMode:"take-away"===a?"EMPORTER":"LIVRAISON",status:"ATTENTE_PAIEMENT",date:(new Date).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})};(0,x.LV)(k,c,n,e)}()},children:["Commander ",_," \u20ac"]})]}):(0,b.jsx)(P,{children:V().reason})},R=t(8052),D=t(3504),B=function(){var e=(0,d.s0)(),n=(0,s.v9)(p.n$);return(0,b.jsxs)("div",{style:{textAlign:"center",border:"6px solid black",padding:"0 8px 8px 8px",width:"100%"},children:[(0,b.jsxs)("p",{children:["Votre adresse : ",n]}),(0,b.jsx)(y.Z,{type:"button",positive:!0,onClick:function(){return e("/vos-infos")},children:"Modifier mon adresse de livraison"})]})},V=t(5861),G=t(7757),Q=t.n(G),U=t(4569),M=t.n(U),F=t(4519),q=function(){var e=(0,V.Z)(Q().mark((function e(n,t,r,a){var i,s,o,c,u,d,l,p,m,f,h;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Date.now()+6e5,s=T,o=O,c=z,e.prev=2,e.next=5,M()({method:"post",url:"".concat(F.Q,"/api/google-api/get-matrix"),headers:{"Accept-Language":"fr"},data:{origin:n.sansAccent(),dest:"".concat(t.sansAccent(),", ").concat(r),now:i}});case 5:u=e.sent,d=u.data.rows,l=d[0].elements[0],p=l.distance,m=l.duration,f=l.duration_in_traffic,h=Math.round(m.value+f.value)/2,p.value>o||!c.includes(r)||h>s?a((0,v.Gk)(!1)):(a((0,v.Gk)(!0)),a((0,v.Ce)(Math.round(h/60)))),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),a((0,v.Gk)(!1)),a((0,v.PJ)({status:"error",message:"Impossible de calculer le temps de livraison estim\xe9"}));case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(n,t,r,a){return e.apply(this,arguments)}}(),N=function(){var e=(0,s.v9)(o.D1),n=(0,s.v9)(o.sE),t=(0,s.v9)(h.n_),r=(0,s.v9)(h.fB),d=C,l=I,f=_;return function(){var e=(0,s.v9)(h.Wf),n=(0,s.v9)(p.n$),t=(0,s.v9)(p.xn),r=(0,s.I0)();(0,i.useEffect)((function(){q(e,n,t,r)}),[n,r,e,t])}(),m(),e.length?(0,b.jsxs)(R.sk,{children:[!t||n<d||J.V<f?(0,b.jsx)(P,{children:t?n<d?"Le montant de votre commande actuel ne permet pas a livraison":J.V<f?"Les livraisons commencent \xe0 partir de ".concat(f,"h , mais vous pouvez commander d\xe9s maintenant afin d'\xeatre livr\xe9 le plus t\xf4t possible"):"":"Votre Addresse actuelle ne permet pas la livraison"}):(0,b.jsx)(P,{children:"Si vous commandez maintenant, votre commande sera chez vous dans ".concat(r+l," minutes")}),(0,b.jsx)(B,{}),(0,b.jsxs)(R.A1,{children:[(0,b.jsx)("h2",{children:"Votre Panier"}),(0,b.jsxs)("span",{children:["Total : ",n," ",(0,b.jsx)("small",{children:"\u20ac"})]})]}),e.map((function(e){return e&&(0,b.jsx)(c.Z,(0,a.Z)((0,a.Z)({},e),{},{isCart:!0,children:(0,b.jsx)(u.Z,{_id:e._id,product:e})}),e._id)})),(0,b.jsx)(L,{})]}):(0,b.jsx)(R.sk,{children:(0,b.jsxs)(R.SK,{children:["Votre Panier est vide actuellement",(0,b.jsx)(D.rU,{to:"/",children:"Retour \xe0 la boutique"})]})})}},8052:function(e,n,t){t.d(n,{sk:function(){return c},A1:function(){return u},SK:function(){return d}});var r,a,i,s=t(168),o=t(5751),c=o.ZP.main(r||(r=(0,s.Z)(["\n  display: flex;\n  flex-direction: column;\n"]))),u=o.ZP.div(a||(a=(0,s.Z)(["\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  h2 {\n    width: 50%;\n  }\n  span {\n    display: inline-block;\n    font-weight: bold;\n    font-size: 1.3em;\n  }\n"]))),d=o.ZP.div(i||(i=(0,s.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: 80vh;\n"])))},3740:function(e,n,t){t.d(n,{LV:function(){return Z},h_:function(){return y},dl:function(){return j},DT:function(){return g},Cs:function(){return w}});var r=t(1413),a=t(4925),i=t(5861),s=t(7757),o=t.n(s),c=t(4569),u=t.n(c),d=t(3623),l=t(4719),p=t(6214),m=function(e){return{type:p.p.GET_ORDERS_BY_USER_ID,payload:e}},f=function(e){return{type:p.p.GET_ALL_ORDERS,payload:e}},v=function(e){return{type:p.p.GET_ALL_RAW_ORDERS,payload:e}},h=t(4519),x=["products"],g=function(){var e=(0,i.Z)(o().mark((function e(n,t,r){var a,i,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,d.o4)()),e.prev=1,e.next=4,u()({method:"GET",url:"".concat(h.Q,"/api/orders/").concat(n),headers:{Authorization:"Bearer ".concat(t)}});case 4:a=e.sent,i=a.data,s=i.orders,c=i.message,r((0,d.o4)()),r(m(s)),r((0,d.PJ)({status:"success",message:c})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),r((0,d.o4)()),r((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n,t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,i.Z)(o().mark((function e(n,t){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u()({method:"GET",url:"".concat(h.Q,"/api/orders/all"),headers:{Authorization:"Bearer ".concat(n)}});case 3:r=e.sent,a=r.data.orders,t(f(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t){return e.apply(this,arguments)}}(),j=function(){var e=(0,i.Z)(o().mark((function e(n,t){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t((0,d.o4)()),e.prev=1,e.next=4,u()({method:"GET",url:"".concat(h.Q,"/api/orders/all-raw"),headers:{Authorization:"Bearer ".concat(n)}});case 4:r=e.sent,a=r.data.orders,t(v(a)),t((0,d.o4)()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t((0,d.o4)()),t((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,s){var c,p,m,f,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i((0,d.o4)()),c=t.products,p=(0,a.Z)(t,x),m=(0,r.Z)((0,r.Z)({},p),{},{products:c.map((function(e){return{_id:e._id,quantity:e.quantity,name:e.name,price:e.price}}))}),e.prev=3,e.next=6,u()({method:"POST",url:"".concat(h.Q,"/api/orders/add"),data:{order:m},headers:{Authorization:"Bearer ".concat(n)}});case 6:f=e.sent,v=f.data.message,i((0,d.o4)()),i((0,d.PJ)({status:"success",message:v})),i((0,l.UY)()),s("/vos-commandes"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),i((0,d.o4)()),i((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(n,t,r,a){return e.apply(this,arguments)}}(),w=function(){var e=(0,i.Z)(o().mark((function e(n,t,r){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,d.o4)()),e.prev=1,e.next=4,u()({method:"POST",url:"".concat(h.Q,"/api/orders/update"),data:{update:t},headers:{Authorization:"Bearer ".concat(n)}});case 4:a=e.sent,i=a.data.message,r((0,d.o4)()),r((0,d.PJ)({status:"success",message:i})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),r((0,d.o4)()),r((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t,r){return e.apply(this,arguments)}}()},8759:function(e,n,t){t.d(n,{G:function(){return p},O:function(){return m}});var r=t(5861),a=t(7757),i=t.n(a),s=t(4569),o=t.n(s),c=t(3623),u=t(4719),d=t(7464),l=t(4519),p=function(){var e=(0,r.Z)(i().mark((function e(n,t,r,a){var s,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,c.o4)()),e.prev=1,e.next=4,o()({method:"POST",url:"".concat(l.Q,"/api/payment/create-payment-intent"),headers:{Authorization:"Bearer ".concat(n)},data:{items:t}});case 4:s=e.sent,r((0,c.o4)()),p=s.data.clientSecret,r((0,d.E)(p)),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(1),r((0,c.o4)()),"Unauthorized"===e.t0.response.data?(r((0,c.PJ)({status:"error",message:"Vous devez \xeatre conn\xe9ct\xe9 pour passer une commande"})),a("/connexion")):r((0,c.PJ)({status:"error",message:e.t0.response.data.message})),a("/"),r((0,u.UY)());case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t,r,a){return e.apply(this,arguments)}}(),m=function(){var e=(0,r.Z)(i().mark((function e(n,t,r,a){var s,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a((0,c.o4)()),e.prev=1,e.next=4,o()({method:"POST",url:"".concat(l.Q,"/api/payment/refund-payment"),headers:{Authorization:"Bearer ".concat(n)},data:{orderId:t,paymentIntent:r}});case 4:s=e.sent,u=s.data.message,a((0,c.o4)()),a((0,c.PJ)({status:"success",message:u})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),a((0,c.o4)()),a((0,c.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t,r,a){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=782.9b8ee5a4.chunk.js.map