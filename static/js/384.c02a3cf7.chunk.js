"use strict";(self.webpackChunkpouletterie=self.webpackChunkpouletterie||[]).push([[384],{2384:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var r=n(4942),a=n(1413),s=n(885),u=n(2791),c=n(6030),o=n(3740),i=n(6368),d=n(3638),l=n(184),p=function(){!function(){var e=(0,c.v9)(i.vI),t=(0,c.I0)();(0,u.useEffect)((function(){(0,o.dl)(e,t)}),[e,t])}();var e=(0,c.v9)(d.bH),t=(0,u.useState)({deliveryMode:"",status:"",date:"",user:""}),n=(0,s.Z)(t,2),p=n[0],f=n[1],h=(0,u.useCallback)((function(){return e.filter((function(e){for(var t in p)if("user"!==t){var n;if(void 0===e[t]||null===(n=e[t])||void 0===n||!n.includes(p[t]))return!1}else{var r="".concat(e[t].lastname," ").concat(e[t].firstname);if(void 0===r||!r.includes(p[t]))return!1}return e}))}),[p,e]),m=(0,u.useCallback)((function(e){var t=e.products,n=e.status;return t.reduce((function(e,t){return"REMBOURSEE"!==n?e+t._id.price*t.quantity:e-t._id.price*t.quantity}),0).toFixed(2)}),[]),v=(0,u.useCallback)((function(){return(h().flatMap((function(e){return e.products})).reduce((function(e,t){return e+t._id.price*t.quantity}),0)+h().flatMap((function(e){return"REMBOURSEE"===e.status?e.products:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e-t._id.price*t.quantity}),0)).toFixed(2)}),[h]),x=Array.from(new Set(e.map((function(e){return"".concat(e.user.lastname," ").concat(e.user.firstname)})).filter((function(e){return void 0!==e})))),j=Array.from(new Set(e.map((function(e){return e.deliveryMode})).filter((function(e){return void 0!==e})))),y=Array.from(new Set(e.map((function(e){return e.status})).filter((function(e){return void 0!==e})))),g=(0,u.useCallback)((function(e){var t=e.target,n=t.name,s=t.value;f((0,a.Z)((0,a.Z)({},p),{},(0,r.Z)({},n,s)))}),[p]);return(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{children:["Total des commandes : ",e.length]}),(0,l.jsxs)("h1",{children:["Total des produits filtr\xe9s : ",h().length]}),(0,l.jsxs)("h2",{children:["Total g\xe9n\xe9ral :",v(),(0,l.jsx)("small",{children:"\u20ac"})]}),(0,l.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around",padding:"12px"},children:[(0,l.jsxs)("select",{name:"user",onChange:g,children:[(0,l.jsx)("option",{value:"",children:"Selectionnez un utilisateur"}),x&&x.map((function(e){return(0,l.jsx)("option",{value:e,children:e},e)}))]}),(0,l.jsxs)("select",{name:"deliveryMode",onChange:g,children:[(0,l.jsx)("option",{value:"",children:"Selectionnez un mode de livraison"}),j&&j.map((function(e){return(0,l.jsx)("option",{value:e,children:e},e)}))]}),(0,l.jsxs)("select",{name:"status",onChange:g,children:[(0,l.jsx)("option",{value:"",children:"Selectionnez status de commande"}),y&&y.map((function(e){return(0,l.jsx)("option",{value:e,children:e},e)}))]}),(0,l.jsxs)("select",{name:"date",onChange:g,children:[(0,l.jsx)("option",{value:"",children:"Selectionnez un mois de l'ann\xe9e"}),Array.from({length:12},(function(e,t){return"".concat(new Date(0,t).toLocaleDateString("fr-FR",{month:"long"})," ").concat((new Date).getFullYear())})).map((function(e){return(0,l.jsx)("option",{value:e,children:e.toUpperCase()},e)}))]}),(0,l.jsxs)("select",{name:"date",onChange:g,children:[(0,l.jsx)("option",{value:"",children:"Selectionnez l'ann\xe9e"}),function(){var e=(new Date).getFullYear(),t=e+10,n=[];n.push(e-1);for(var r=e;r<=t;r++)n.push(r);return n}().map((function(e){return(0,l.jsx)("option",{value:e,children:e},e)}))]})]}),(0,l.jsx)("div",{children:(0,l.jsxs)("table",{style:{textAlign:"center",width:"100%"},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"utilisateur"}),(0,l.jsx)("th",{children:"date"}),(0,l.jsx)("th",{children:"mode"}),(0,l.jsx)("th",{children:"status"}),(0,l.jsx)("th",{children:"montant commande"}),(0,l.jsx)("th",{children:"produits command\xe9s"})]})}),(0,l.jsx)("tbody",{children:h().map((function(e){return(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{children:[e.user.lastname," ",e.user.firstname]}),(0,l.jsx)("td",{children:e.date}),(0,l.jsx)("td",{children:e.deliveryMode}),(0,l.jsx)("td",{children:e.status}),(0,l.jsxs)("td",{children:[e&&m(e),(0,l.jsx)("small",{children:"\u20ac"})]}),(0,l.jsx)("td",{children:(0,l.jsx)("ul",{style:{listStyle:"none"},children:e.products.map((function(e,t){var n=e._id,r=e.quantity;return(0,l.jsxs)("li",{style:{textAlign:"center"},children:[n.name," x ",r]},n+t)}))})})]},e._id)}))})]})})]})}},3740:function(e,t,n){n.d(t,{LV:function(){return w},h_:function(){return y},dl:function(){return g},DT:function(){return j},Cs:function(){return S}});var r=n(1413),a=n(4925),s=n(5861),u=n(7757),c=n.n(u),o=n(4569),i=n.n(o),d=n(3623),l=n(4719),p=n(6214),f=function(e){return{type:p.p.GET_ORDERS_BY_USER_ID,payload:e}},h=function(e){return{type:p.p.GET_ALL_ORDERS,payload:e}},m=function(e){return{type:p.p.GET_ALL_RAW_ORDERS,payload:e}},v=n(4519),x=["products"],j=function(){var e=(0,s.Z)(c().mark((function e(t,n,r){var a,s,u,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,d.o4)()),e.prev=1,e.next=4,i()({method:"GET",url:"".concat(v.Q,"/api/orders/").concat(t),headers:{Authorization:"Bearer ".concat(n)}});case 4:a=e.sent,s=a.data,u=s.orders,o=s.message,r((0,d.o4)()),r(f(u)),r((0,d.PJ)({status:"success",message:o})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),r((0,d.o4)()),r((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,s.Z)(c().mark((function e(t,n){var r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"GET",url:"".concat(v.Q,"/api/orders/all"),headers:{Authorization:"Bearer ".concat(t)}});case 3:r=e.sent,a=r.data.orders,n(h(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=(0,s.Z)(c().mark((function e(t,n){var r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"GET",url:"".concat(v.Q,"/api/orders/all-raw"),headers:{Authorization:"Bearer ".concat(t)}});case 3:r=e.sent,a=r.data.orders,n(m(a)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),n((0,d.o4)()),n((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=(0,s.Z)(c().mark((function e(t,n,s,u){var o,p,f,h,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s((0,d.o4)()),o=n.products,p=(0,a.Z)(n,x),f=(0,r.Z)((0,r.Z)({},p),{},{products:o.map((function(e){return{_id:e._id,quantity:e.quantity}}))}),e.prev=3,e.next=6,i()({method:"POST",url:"".concat(v.Q,"/api/orders/add"),data:{order:f},headers:{Authorization:"Bearer ".concat(t)}});case 6:h=e.sent,m=h.data.message,s((0,d.o4)()),s((0,d.PJ)({status:"success",message:m})),s((0,l.UY)()),u("/vos-commandes"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),s((0,d.o4)()),s((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),S=function(){var e=(0,s.Z)(c().mark((function e(t,n,r){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,d.o4)()),e.prev=1,e.next=4,i()({method:"POST",url:"".concat(v.Q,"/api/orders/update"),data:{update:n},headers:{Authorization:"Bearer ".concat(t)}});case 4:a=e.sent,s=a.data.message,r((0,d.o4)()),r((0,d.PJ)({status:"success",message:s})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),r((0,d.o4)()),r((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n,r){return e.apply(this,arguments)}}()},3638:function(e,t,n){n.d(t,{qI:function(){return s},pi:function(){return u},bH:function(){return c}});var r=n(6916),a=function(e){return e.order},s=(0,r.P1)([a],(function(e){return e.userOrders})),u=(0,r.P1)([a],(function(e){return e.allOrders})),c=(0,r.P1)([a],(function(e){return e.rawOrders}))}}]);
//# sourceMappingURL=384.c02a3cf7.chunk.js.map