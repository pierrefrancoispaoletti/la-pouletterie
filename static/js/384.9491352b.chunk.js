"use strict";(self.webpackChunkpouletterie=self.webpackChunkpouletterie||[]).push([[384],{2384:function(e,n,t){t.r(n),t.d(n,{default:function(){return p}});var r=t(4942),a=t(1413),s=t(885),u=t(2791),c=t(6030),o=t(3740),i=t(6368),l=t(3638),d=t(184),p=function(){!function(){var e=(0,c.v9)(i.vI),n=(0,c.I0)();(0,u.useEffect)((function(){(0,o.dl)(e,n)}),[e,n])}();var e=(0,c.v9)(l.bH),n=(0,u.useState)({deliveryMode:"",status:"",date:"",user:""}),t=(0,s.Z)(n,2),p=t[0],h=t[1],f=(0,u.useCallback)((function(){var e=(new Date).getFullYear(),n=e+10,t=[];t.push(e-1);for(var r=e;r<=n;r++)t.push(r);return t}),[]),v=(0,u.useCallback)((function(){return Array.from({length:12},(function(e,n){return"".concat(new Date(0,n).toLocaleDateString("fr-FR",{month:"long"})," ").concat((new Date).getFullYear())}))}),[]),m=(0,u.useCallback)((function(){return e.filter((function(e){for(var n in p)if("user"!==n){var t;if(void 0===e[n]||null===(t=e[n])||void 0===t||!t.includes(p[n]))return!1}else{var r="".concat(e[n].lastname," ").concat(e[n].firstname);if(void 0===r||!r.includes(p[n]))return!1}return e}))}),[p,e]),x=(0,u.useCallback)((function(e){var n=e.products,t=e.status;return n.reduce((function(e,n){return"REMBOURSEE"!==t?e+n.price*n.quantity:e-n.price*n.quantity}),0).toFixed(2)}),[]),j=(0,u.useCallback)((function(){return(m().flatMap((function(e){return e.products})).reduce((function(e,n){return e+n.price*n.quantity}),0)+m().flatMap((function(e){return"REMBOURSEE"===e.status?e.products:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,n){return e-n.price*n.quantity}),0)).toFixed(2)}),[m]),g=(0,u.useCallback)((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return n&&t&&r?Array.from(new Set(e.map((function(e){return"".concat(e[n][t]," ").concat(e[n][r])})).filter((function(e){return void 0!==e})))):Array.from(new Set(e.map((function(e){return e[n]})).filter((function(e){return void 0!==e}))))}),[e]),y=g("user","lastname","firstname"),k=g("deliveryMode"),w=g("status"),b=(0,u.useCallback)((function(e){var n=e.target,t=n.name,s=n.value;h((0,a.Z)((0,a.Z)({},p),{},(0,r.Z)({},t,s)))}),[p]);return(0,d.jsxs)("div",{children:[(0,d.jsxs)("h1",{children:["Total des commandes : ",e.length]}),(0,d.jsxs)("h1",{children:["Total des produits filtr\xe9s : ",m().length]}),(0,d.jsxs)("h2",{children:["Total g\xe9n\xe9ral :",j(),(0,d.jsx)("small",{children:"\u20ac"})]}),(0,d.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around",padding:"12px"},children:[(0,d.jsxs)("select",{name:"user",onChange:b,children:[(0,d.jsx)("option",{value:"",children:"Selectionnez un utilisateur"}),y&&y.map((function(e){return(0,d.jsx)("option",{value:e,children:e},e)}))]}),(0,d.jsxs)("select",{name:"deliveryMode",onChange:b,children:[(0,d.jsx)("option",{value:"",children:"Selectionnez un mode de livraison"}),k&&k.map((function(e){return(0,d.jsx)("option",{value:e,children:e},e)}))]}),(0,d.jsxs)("select",{name:"status",onChange:b,children:[(0,d.jsx)("option",{value:"",children:"Selectionnez status de commande"}),w&&w.map((function(e){return(0,d.jsx)("option",{value:e,children:e},e)}))]}),(0,d.jsxs)("select",{name:"date",onChange:b,children:[(0,d.jsx)("option",{value:"",children:"Selectionnez un mois de l'ann\xe9e"}),v().map((function(e){return(0,d.jsx)("option",{value:e,children:e.toUpperCase()},e)}))]}),(0,d.jsxs)("select",{name:"date",onChange:b,children:[(0,d.jsx)("option",{value:"",children:"Selectionnez l'ann\xe9e"}),f().map((function(e){return(0,d.jsx)("option",{value:e,children:e},e)}))]})]}),(0,d.jsx)("div",{children:(0,d.jsxs)("table",{style:{textAlign:"center",width:"100%"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"utilisateur"}),(0,d.jsx)("th",{children:"date"}),(0,d.jsx)("th",{children:"mode"}),(0,d.jsx)("th",{children:"status"}),(0,d.jsx)("th",{children:"montant commande"}),(0,d.jsx)("th",{children:"produits command\xe9s"})]})}),(0,d.jsx)("tbody",{children:m().map((function(e){return(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[e.user.lastname," ",e.user.firstname]}),(0,d.jsx)("td",{children:e.date}),(0,d.jsx)("td",{children:e.deliveryMode}),(0,d.jsx)("td",{children:e.status}),(0,d.jsxs)("td",{children:[e&&x(e),(0,d.jsx)("small",{children:"\u20ac"})]}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{style:{listStyle:"none"},children:e.products.map((function(e,n){var t=e._id,r=e.quantity,a=e.name;return(0,d.jsxs)("li",{style:{textAlign:"center"},children:[a," x ",r]},t+n)}))})})]},e._id)}))})]})})]})}},3740:function(e,n,t){t.d(n,{LV:function(){return k},h_:function(){return g},dl:function(){return y},DT:function(){return j},Cs:function(){return w}});var r=t(1413),a=t(4925),s=t(5861),u=t(7757),c=t.n(u),o=t(4569),i=t.n(o),l=t(3623),d=t(4719),p=t(6214),h=function(e){return{type:p.p.GET_ORDERS_BY_USER_ID,payload:e}},f=function(e){return{type:p.p.GET_ALL_ORDERS,payload:e}},v=function(e){return{type:p.p.GET_ALL_RAW_ORDERS,payload:e}},m=t(4519),x=["products"],j=function(){var e=(0,s.Z)(c().mark((function e(n,t,r){var a,s,u,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,l.o4)()),e.prev=1,e.next=4,i()({method:"GET",url:"".concat(m.Q,"/api/orders/").concat(n),headers:{Authorization:"Bearer ".concat(t)}});case 4:a=e.sent,s=a.data,u=s.orders,o=s.message,r((0,l.o4)()),r(h(u)),r((0,l.PJ)({status:"success",message:o})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),r((0,l.o4)()),r((0,l.PJ)({status:"error",message:e.t0.response.data.message}));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n,t,r){return e.apply(this,arguments)}}(),g=function(){var e=(0,s.Z)(c().mark((function e(n,t){var r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"GET",url:"".concat(m.Q,"/api/orders/all"),headers:{Authorization:"Bearer ".concat(n)}});case 3:r=e.sent,a=r.data.orders,t(f(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t((0,l.PJ)({status:"error",message:e.t0.response.data.message}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t){return e.apply(this,arguments)}}(),y=function(){var e=(0,s.Z)(c().mark((function e(n,t){var r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t((0,l.o4)()),e.prev=1,e.next=4,i()({method:"GET",url:"".concat(m.Q,"/api/orders/all-raw"),headers:{Authorization:"Bearer ".concat(n)}});case 4:r=e.sent,a=r.data.orders,t(v(a)),t((0,l.o4)()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t((0,l.o4)()),t((0,l.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t){return e.apply(this,arguments)}}(),k=function(){var e=(0,s.Z)(c().mark((function e(n,t,s,u){var o,p,h,f,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s((0,l.o4)()),o=t.products,p=(0,a.Z)(t,x),h=(0,r.Z)((0,r.Z)({},p),{},{products:o.map((function(e){return{_id:e._id,quantity:e.quantity,name:e.name,price:e.price}}))}),e.prev=3,e.next=6,i()({method:"POST",url:"".concat(m.Q,"/api/orders/add"),data:{order:h},headers:{Authorization:"Bearer ".concat(n)}});case 6:f=e.sent,v=f.data.message,s((0,l.o4)()),s((0,l.PJ)({status:"success",message:v})),s((0,d.UY)()),u("/vos-commandes"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),s((0,l.o4)()),s((0,l.PJ)({status:"error",message:e.t0.response.data.message}));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(n,t,r,a){return e.apply(this,arguments)}}(),w=function(){var e=(0,s.Z)(c().mark((function e(n,t,r){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,l.o4)()),e.prev=1,e.next=4,i()({method:"POST",url:"".concat(m.Q,"/api/orders/update"),data:{update:t},headers:{Authorization:"Bearer ".concat(n)}});case 4:a=e.sent,s=a.data.message,r((0,l.o4)()),r((0,l.PJ)({status:"success",message:s})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),r((0,l.o4)()),r((0,l.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,t,r){return e.apply(this,arguments)}}()},3638:function(e,n,t){t.d(n,{qI:function(){return s},pi:function(){return u},bH:function(){return c}});var r=t(6916),a=function(e){return e.order},s=(0,r.P1)([a],(function(e){return e.userOrders})),u=(0,r.P1)([a],(function(e){return e.allOrders})),c=(0,r.P1)([a],(function(e){return e.rawOrders}))}}]);
//# sourceMappingURL=384.9491352b.chunk.js.map