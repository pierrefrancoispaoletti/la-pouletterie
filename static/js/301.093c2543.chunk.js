"use strict";(self.webpackChunkpouletterie=self.webpackChunkpouletterie||[]).push([[301],{8301:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var r=n(1413),a=n(2791),s=n(6030),c=n(3740),o=n(3638),u=n(6368),i=n(2411),d=n(4483),l=n(2881),p=n(1448),h=n(8052),f=n(3504),m=n(8759),v=n(5861),x=n(885),y=n(7757),j=n.n(y),E=n(6398),g=n(184),P=function(){var e=(0,s.v9)(u.vI),t=(0,s.I0)(),n=(0,s.v9)(E.Wf),y=(0,s.v9)(o.pi);!function(){var e,t=(0,a.useState)(!1),n=(0,x.Z)(t,2),r=n[0],o=n[1],i=(0,s.I0)(),d=(0,s.v9)(u.vI);(0,a.useEffect)((function(){return o(!0),r&&(e=setInterval((0,v.Z)(j().mark((function e(){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.h_)(d,i);case 2:case"end":return e.stop()}}),e)}))),3e3)),function(){o(!1),clearInterval(e)}}),[d,r])}();var P=function(n){var a=(0,r.Z)({},n);"PAYEE"===n.status&&(a.status="LIVREE"),"ATTENTE_PAIEMENT"===n.status&&(a.status="LIVREE"),"ATTENTE_PAIEMENT"===n.status&&"EMPORTER"===n.deliveryMode&&(a.status="RECUPEREE"),(0,c.Cs)(e,a,t)};return y.length?(0,g.jsx)("div",{style:{width:"100%"},children:(0,g.jsxs)("table",{style:{textAlign:"center",width:"100%"},children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:"Client"}),(0,g.jsx)("th",{children:"Date"}),(0,g.jsx)("th",{children:"Telephone"}),(0,g.jsx)("th",{children:"Mail"}),(0,g.jsx)("th",{children:"Status"}),(0,g.jsx)("th",{children:"Mode"}),(0,g.jsx)("th",{children:"Adresse"}),(0,g.jsx)("th",{children:"Commande"}),(0,g.jsx)("th",{children:"Actions"})]})}),(0,g.jsx)("tbody",{children:y&&y.map((function(r){return(0,g.jsxs)("tr",{children:[(0,g.jsxs)("td",{children:[r.user.firstname," ",r.user.lastname]}),(0,g.jsx)("td",{children:r.date}),(0,g.jsx)("td",{children:(0,g.jsx)("a",{href:"tel:".concat(r.user.phone),children:(0,g.jsx)(d.G,{icon:l.j1w})})}),(0,g.jsx)("td",{children:(0,g.jsx)("a",{href:"mailto:".concat(r.user.email),children:(0,g.jsx)(d.G,{icon:l.FU$})})}),(0,g.jsx)("td",{children:r.status}),(0,g.jsx)("td",{children:r.deliveryMode}),(0,g.jsx)("td",{children:(0,g.jsx)("a",{rel:"noreferrer",target:"_blank",href:"https://www.google.com/maps/dir/?api=1&origin=".concat(n,"&destination=").concat(r.deliveryAddress,"&travelmode=driving"),children:r.deliveryAddress})}),(0,g.jsx)("td",{children:(0,g.jsx)("ul",{style:{listStyle:"none"},children:r.products.map((function(e,t){var n=e.quantity,a=e.name;return(0,g.jsxs)("li",{children:[a," x ",n]},r._id+t)}))})}),(0,g.jsxs)("td",{children:["EMPORTER"!==r.deliveryMode&&(0,g.jsx)(i.Z,{type:"button",onClick:function(){return P(r)},children:"Livr\xe9e / Pay\xe9e"}),"EMPORTER"===r.deliveryMode&&(0,g.jsx)(i.Z,{type:"button",onClick:function(){return P(r)},children:"Commande R\xe9cuper\xe9e"}),r.paymentIntent&&(0,g.jsx)(i.Z,{type:"button",negative:!0,onClick:function(){return n=r._id,a=r.paymentIntent,void(0,m.O)(e,n,a,t);var n,a},children:"Rembourser la commande"})]})]},r._id)}))})]})}):(0,g.jsx)(p.Q,{children:(0,g.jsxs)(h.SK,{children:["Vous n'avez pas de commandes pour le moment",(0,g.jsx)(f.rU,{to:"/",children:"Retour \xe0 l'accueil"})]})})}},8052:function(e,t,n){n.d(t,{sk:function(){return u},A1:function(){return i},SK:function(){return d}});var r,a,s,c=n(168),o=n(5751),u=o.ZP.main(r||(r=(0,c.Z)(["\n  display: flex;\n  flex-direction: column;\n"]))),i=o.ZP.div(a||(a=(0,c.Z)(["\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  h2 {\n    width: 50%;\n  }\n  span {\n    display: inline-block;\n    font-weight: bold;\n    font-size: 1.3em;\n  }\n"]))),d=o.ZP.div(s||(s=(0,c.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: 80vh;\n"])))},1448:function(e,t,n){n.d(t,{Q:function(){return s}});var r,a=n(168),s=n(5751).ZP.main(r||(r=(0,a.Z)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n"])))},3740:function(e,t,n){n.d(t,{LV:function(){return g},h_:function(){return j},dl:function(){return E},DT:function(){return y},Cs:function(){return P}});var r=n(1413),a=n(4925),s=n(5861),c=n(7757),o=n.n(c),u=n(4569),i=n.n(u),d=n(3623),l=n(4719),p=n(6214),h=function(e){return{type:p.p.GET_ORDERS_BY_USER_ID,payload:e}},f=function(e){return{type:p.p.GET_ALL_ORDERS,payload:e}},m=function(e){return{type:p.p.GET_ALL_RAW_ORDERS,payload:e}},v=n(4519),x=["products"],y=function(){var e=(0,s.Z)(o().mark((function e(t,n,r){var a,s,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,d.o4)()),e.prev=1,e.next=4,i()({method:"GET",url:"".concat(v.Q,"/api/orders/").concat(t),headers:{Authorization:"Bearer ".concat(n)}});case 4:a=e.sent,s=a.data,c=s.orders,u=s.message,r((0,d.o4)()),r(h(c)),r((0,d.PJ)({status:"success",message:u})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),r((0,d.o4)()),r((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n,r){return e.apply(this,arguments)}}(),j=function(){var e=(0,s.Z)(o().mark((function e(t,n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"GET",url:"".concat(v.Q,"/api/orders/all"),headers:{Authorization:"Bearer ".concat(t)}});case 3:r=e.sent,a=r.data.orders,n(f(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=(0,s.Z)(o().mark((function e(t,n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n((0,d.o4)()),e.prev=1,e.next=4,i()({method:"GET",url:"".concat(v.Q,"/api/orders/all-raw"),headers:{Authorization:"Bearer ".concat(t)}});case 4:r=e.sent,a=r.data.orders,n(m(a)),n((0,d.o4)()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),n((0,d.o4)()),n((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=(0,s.Z)(o().mark((function e(t,n,s,c){var u,p,h,f,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s((0,d.o4)()),u=n.products,p=(0,a.Z)(n,x),h=(0,r.Z)((0,r.Z)({},p),{},{products:u.map((function(e){return{_id:e._id,quantity:e.quantity,name:e.name,price:e.price}}))}),e.prev=3,e.next=6,i()({method:"POST",url:"".concat(v.Q,"/api/orders/add"),data:{order:h},headers:{Authorization:"Bearer ".concat(t)}});case 6:f=e.sent,m=f.data.message,s((0,d.o4)()),s((0,d.PJ)({status:"success",message:m})),s((0,l.UY)()),c("/vos-commandes"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),s((0,d.o4)()),s((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),P=function(){var e=(0,s.Z)(o().mark((function e(t,n,r){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,d.o4)()),e.prev=1,e.next=4,i()({method:"POST",url:"".concat(v.Q,"/api/orders/update"),data:{update:n},headers:{Authorization:"Bearer ".concat(t)}});case 4:a=e.sent,s=a.data.message,r((0,d.o4)()),r((0,d.PJ)({status:"success",message:s})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),r((0,d.o4)()),r((0,d.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n,r){return e.apply(this,arguments)}}()},8759:function(e,t,n){n.d(t,{G:function(){return p},O:function(){return h}});var r=n(5861),a=n(7757),s=n.n(a),c=n(4569),o=n.n(c),u=n(3623),i=n(4719),d=n(7464),l=n(4519),p=function(){var e=(0,r.Z)(s().mark((function e(t,n,r,a){var c,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((0,u.o4)()),e.prev=1,e.next=4,o()({method:"POST",url:"".concat(l.Q,"/api/payment/create-payment-intent"),headers:{Authorization:"Bearer ".concat(t)},data:{items:n}});case 4:c=e.sent,r((0,u.o4)()),p=c.data.clientSecret,r((0,d.E)(p)),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(1),r((0,u.o4)()),"Unauthorized"===e.t0.response.data?(r((0,u.PJ)({status:"error",message:"Vous devez \xeatre conn\xe9ct\xe9 pour passer une commande"})),a("/connexion")):r((0,u.PJ)({status:"error",message:e.t0.response.data.message})),a("/"),r((0,i.UY)());case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),h=function(){var e=(0,r.Z)(s().mark((function e(t,n,r,a){var c,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a((0,u.o4)()),e.prev=1,e.next=4,o()({method:"POST",url:"".concat(l.Q,"/api/payment/refund-payment"),headers:{Authorization:"Bearer ".concat(t)},data:{orderId:n,paymentIntent:r}});case 4:c=e.sent,i=c.data.message,a((0,u.o4)()),a((0,u.PJ)({status:"success",message:i})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),a((0,u.o4)()),a((0,u.PJ)({status:"error",message:e.t0.response.data.message}));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},3638:function(e,t,n){n.d(t,{qI:function(){return s},pi:function(){return c},bH:function(){return o}});var r=n(6916),a=function(e){return e.order},s=(0,r.P1)([a],(function(e){return e.userOrders})),c=(0,r.P1)([a],(function(e){return e.allOrders})),o=(0,r.P1)([a],(function(e){return e.rawOrders}))}}]);
//# sourceMappingURL=301.093c2543.chunk.js.map